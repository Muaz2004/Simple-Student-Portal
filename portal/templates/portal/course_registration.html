{% extends "portal/layout.html" %}

{% block body %}
<div class="max-w-2xl mx-auto p-6">

    {% if message %}
        <p class="text-center text-red-600 font-semibold mb-4">{{ message }}</p>
    {% endif %}

    <!-- Academic Year & Semester Selection -->
    <form action="{% url 'cregistration' %}" method="get" class="space-y-4 mb-6 bg-white p-4 rounded shadow">
        {% csrf_token %}
        <div>
            <label for="ay" class="block font-semibold mb-1">Academic Year</label>
            <input type="number" name="acyear" id="ay" required placeholder="e.g. 2024"
                   class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400">
        </div>
        <div>
            <label for="sem" class="block font-semibold mb-1">Semester</label>
            <input type="number" name="semister" id="sem" required placeholder="e.g. 1 or 2"
                   class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400">
        </div>
        <button type="submit" class="w-full bg-blue-600 text-white font-semibold py-2 rounded hover:bg-blue-700 transition">Get Courses</button>
    </form>

    {% if av_course %}
    <div class="bg-white p-4 rounded shadow">
        <h4 class="text-lg font-semibold mb-4 text-center">Course Registration</h4>
        <form method="POST" action="{% url 'cregistration' %}" class="space-y-4">
            {% csrf_token %}
            <input type="hidden" name="acyear" value="{{ request.GET.acyear }}">
            <input type="hidden" name="semister" value="{{ request.GET.semister }}">
            
            <div>
                <label for="course_select" class="block font-semibold mb-1">Select Courses</label>
                <select name="courses[]" id="course_select" multiple
                        class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400">
                    {% for course in av_course %}
                        <option value="{{ course.id }}">{{ course.CourseName }}</option>
                    {% endfor %}
                </select>
                <p class="text-gray-500 text-sm mt-1">Hold Ctrl (Windows) or Cmd (Mac) to select multiple courses.</p>
            </div>

            <button type="submit" class="w-full bg-green-600 text-white font-semibold py-2 rounded hover:bg-green-700 transition">Submit Registration</button>
        </form>
    </div>
    {% else %}
        <p class="text-center text-gray-600 font-semibold">No courses available for this academic year and semester.</p>
    {% endif %}
</div>
{% endblock %}
